<!-- Generated by SVF Cloud. Do not edit. -->
<!-- @version 1.2.10.1        -->
<apex:page id="svf_preview" applyBodyTag="False" applyHtmlTag="False" docType="html-5.0" standardController="Case" extensions="svfcloud.PreviewController" showheader="false" sidebar="false" standardStylesheets="false"  >
<apex:includeScript value="{!URLFOR(ResourceRootPath + '/lib/js/jquery-1.8.3.min.js')}"/>
<apex:includeScript value="/soap/ajax/58.0/connection.js" />
<apex:includeScript value="/soap/ajax/58.0/apex.js" />
<apex:includeScript value="/canvas/sdk/js/publisher.js" />
<apex:includeScript value="{!$Resource.svfcloud__SVFPreviewJS}"/>
  <style>
    html {
      height: 100%;
    }
    body {
        height: 100%;
        margin: 0px;
        border: 0px;
    }
    form {
        position: absolute;
        word-wrap : break-word;
        overflow-wrap : break-word;
        width: 100%;
    }
    .menu {
      margin-right: 40px;
      display: inline-block;
    }
  </style>
  <apex:slds />
  <script>
  var buttonsJson = '[{"fullName":"SVFCaseButton20240413093911899xCD","label":"自賠責保険　書類送付","previewSkip":false},{"fullName":"SVFCaseButton20240413102128702LH6","label":"自賠責保険　不備通知","previewSkip":false},{"fullName":"SVFCaseButton20240413155103023EYI","label":"自賠責保険　督促通知","previewSkip":false},{"fullName":"SVFCaseButton20240413155145446tmn","label":"自賠責保険　解約完了","previewSkip":false},{"fullName":"SVFCaseButton20240505124130273eyq","label":"火新　本社異動受付　変更依頼書","previewSkip":false}]';
  var buttons = JSON.parse(buttonsJson);
  var sObject = 'Case';
  var recordId = '{!Case.Id}';
  var sfdcUrl = '{!LEFT($Api.Partner_Server_URL_580,FIND("/services/Soap/", $Api.Partner_Server_URL_580)-1)}'

  console.log('svfc button: '+buttonsJson);

  // dropdown button
  jQuery(function () {
    if (buttons && !buttons[0]) {
      return;
    }
    var dropdownMenuList = jQuery('div#svfcloud-dropdown-menu');
    for (var menu in buttons) {
      if (!buttons[menu].previewSkip) {
        continue;
      }
      var commandLink = jQuery('a[link-id="commandLink_' + buttons[menu].fullName + '"]');
      commandLink.get(0).onclick = "";
      jQuery(commandLink).on('click', {
        menuTitle: buttons[menu].label,
        previewSkip: buttons[menu].previewSkip,
        printedFlg: buttons[menu].forbiddenField,
        svfcButtonName: buttons[menu].fullName,
        sobj: sObject,
        recordId: recordId,
        sfdcUrl: sfdcUrl,
        type: 'lightning-single'
      }, function (event) {
        var self = event.data;
        var target = 'svfpreview_' + new Date().getTime();
        var screenLeft = window.screenX;
        var screenTop = window.screenY;
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = (self.printedFlg != null) 
          ? self.sfdcUrl + '/apex/svfcloud__PreviewPage?appId=' + self.sobj + '&id=' + self.recordId + '&buttonFullName=' + self.svfcButtonName + '&printedFlg=' + self.printedFlg 
          : self.sfdcUrl + '/apex/svfcloud__PreviewPage?appId=' + self.sobj + '&id=' + self.recordId + '&buttonFullName=' + self.svfcButtonName;
        form.target = target;

        function formSubmit() {
          var body = document.getElementsByTagName('body')[0];
          body.appendChild(form);
          form.submit();
          body.removeChild(form);
        }

        function closeQuickAction() {
          Sfdc.canvas.publisher.publish({
            name: "publisher.close",
            payload: {
              refresh: "true"
            }
          });
        }
        if (self.previewSkip) {
          var iframePreview = svfcPreview.createIFramePreview();
          var linkForm =  jQuery('body form');
          linkForm.html('');
          iframePreview.start(self.menuTitle, self.svfcButtonName,linkForm, target, self.type, formSubmit, closeQuickAction);
          // var iframePreview = svfcPreview.createIFramePreview();
          // iframePreview.start(self.menuTitle, self.svfcButtonName, event.target.parentElement, target, self.type, formSubmit, closeQuickAction);
        } else {
          var popup = window.open("about:blank", target, "menubar=no, toolbar=no, scrollbars=yes, resizable=yes, width=600, height=300, top=" + screenTop + ", left=" + screenLeft);
          if (popup) {
            popup.focus();
            formSubmit();
            setTimeout(closeQuickAction, 100);
          }
        }
      });
    }
  });

  // sigle button
  jQuery(function () {
    if (buttons && buttons[0]) {
      return;
    }
    var self = {
      menuTitle: buttons.label,
      previewSkip: buttons.previewSkip,
      printedFlg: buttons.forbiddenField,
      svfcButtonName: buttons.fullName,
      sobj: sObject,
      recordId: recordId,
      sfdcUrl: sfdcUrl
    };
    var target = "svfpreview_" + new Date().getTime();

    function formSubmit() {
      var form = document.createElement('form');
      form.method = 'POST';
      form.action = (buttons.forbiddenField != null) 
        ? self.sfdcUrl + '/apex/svfcloud__PreviewPage?appId=' + self.sobj + '&id=' + self.recordId + '&buttonFullName=' + self.svfcButtonName + '&printedFlg=' + self.printedFlg 
        : self.sfdcUrl + '/apex/svfcloud__PreviewPage?appId=' + self.sobj + '&id=' + self.recordId + '&buttonFullName=' + self.svfcButtonName;
      form.target = target;
      var body = document.getElementsByTagName('body')[0];
      body.appendChild(form);
      form.submit();
      body.removeChild(form);
    }

    function closeQuickAction() {
      Sfdc.canvas.publisher.publish({
        name: "publisher.close",
        payload: {
          refresh: "true"
        }
      });
    }
    if (self.previewSkip) {
      var ifrmePreview = svfcPreview.createIFramePreview();
      ifrmePreview.start(self.menuTitle, self.svfcButtonName, document.getElementById('svfcloud-lightning-sigle-preview-skip'), target, 'lightning-single', formSubmit, closeQuickAction);
    } else {
      var popup = window.open("about:blank", target, "menubar=no, toolbar=no, scrollbars=yes, resizable=yes, width=600, height=300, top=" + screenTop + ", left=" + screenLeft);
      if (popup) {
        popup.focus();
        formSubmit();
        setTimeout(closeQuickAction, 100);
      }
    }
  });
  </script>

  <apex:form id="svfcf" >
  <apex:commandLink styleClass="menu" html-link-id="commandLink_SVFCaseButton20240413093911899xCD" action="{!getPreviewReference}" value="自賠責保険　書類送付" >
    <apex:param value="SVFCaseButton20240413093911899xCD" name="buttonFullName" assignTo="{!buttonFullName}"/>
  </apex:commandLink>
  <apex:commandLink styleClass="menu" html-link-id="commandLink_SVFCaseButton20240413102128702LH6" action="{!getPreviewReference}" value="自賠責保険　不備通知" >
    <apex:param value="SVFCaseButton20240413102128702LH6" name="buttonFullName" assignTo="{!buttonFullName}"/>
  </apex:commandLink>
  <apex:commandLink styleClass="menu" html-link-id="commandLink_SVFCaseButton20240413155103023EYI" action="{!getPreviewReference}" value="自賠責保険　督促通知" >
    <apex:param value="SVFCaseButton20240413155103023EYI" name="buttonFullName" assignTo="{!buttonFullName}"/>
  </apex:commandLink>
  <apex:commandLink styleClass="menu" html-link-id="commandLink_SVFCaseButton20240413155145446tmn" action="{!getPreviewReference}" value="自賠責保険　解約完了" >
    <apex:param value="SVFCaseButton20240413155145446tmn" name="buttonFullName" assignTo="{!buttonFullName}"/>
  </apex:commandLink>
  <apex:commandLink styleClass="menu" html-link-id="commandLink_SVFCaseButton20240505124130273eyq" action="{!getPreviewReference}" value="火新　本社異動受付　変更依頼書" >
    <apex:param value="SVFCaseButton20240505124130273eyq" name="buttonFullName" assignTo="{!buttonFullName}"/>
  </apex:commandLink>

  </apex:form>
  <div id="svfcloud-lightning-sigle-preview-skip">
  </div>
</apex:page>